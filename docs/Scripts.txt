CREATE DATABASE LABORATORIO;

CREATE TABLE PESQUISADOR(
	CPF 		VARCHAR(11) NOT NULL,
	NOME		VARCHAR(40) NOT NULL,
	TITULACAO	VARCHAR(50),
	ENDERECO	VARCHAR(150),
	TELEFONE	VARCHAR(15),
	EMAIL		VARCHAR(30),
	BIOGRAFIA	VARCHAR(100),
	IS_ALUNO	TINYINT(1) NOT NULL,
	IS_PROFESSOR	TINYINT(1) NOT NULL,
	IS_COLABORADOR	TINYINT(1) NOT NULL,
	PRIMARY KEY (CPF)
);

CREATE TABLE ALUNO(
	CPF 	VARCHAR(11) NOT NULL REFERENCES PESQUISADOR(CPF),
	RA		VARCHAR(10) NOT NULL,
	PRIMARY KEY (CPF)
);

CREATE TABLE GRADUANDOIC(
	CPF 		VARCHAR(11) NOT NULL REFERENCES ALUNO(CPF),
	DATA_INICIAL	DATE NOT NULL,
	DATA_FINAL	DATE,
	PRIMARY KEY (CPF)
);

CREATE TABLE MESTRANDO(
	CPF 		VARCHAR(11) NOT NULL REFERENCES ALUNO(CPF),
	DATA_INICIAL	DATE NOT NULL,
	DATA_FINAL	DATE,
	PRIMARY KEY (CPF)
);

CREATE TABLE DOUTORANDO(
	CPF 		VARCHAR(11) NOT NULL REFERENCES ALUNO(CPF),
	DATA_INICIAL	DATE NOT NULL,
	DATA_FINAL	DATE,
	PRIMARY KEY (CPF)
);

CREATE TABLE PROFESSOR(
	CPF 				VARCHAR(11) NOT NULL REFERENCES PESQUISADOR(CPF),
	DATA_INICIAL			DATE  NOT NULL,
	DATA_FINAL			DATE,
	NOME_LABORATORIO		VARCHAR(30),
	DATA_INICIAL_COORDENA_LAB	DATE,
	DATA_FINAL_COORDENA_LAB		DATE,
	PRIMARY KEY (CPF)
);

CREATE TABLE LABORATORIO(
	NOME 		VARCHAR(30) PRIMARY KEY NOT NULL,
	ENDERECO	VARCHAR(150),
	PRIMARY KEY (NOME)
);

CREATE TABLE COLABORADOR(
	CPF 			VARCHAR(11) NOT NULL REFERENCES PESQUISADOR(CPF),
	IS_POS_DOUTORANDO	TINYINT(1) NOT NULL,
	IS_PROF			TINYINT(1) NOT NULL,
	PRIMARY KEY (CPF)
);

CREATE TABLE POS_DOUTORANDO(
	CPF 		VARCHAR(11) NOT NULL REFERENCES COLABORADOR(CPF),
	DATA_INICIAL	DATE NOT NULL,
	DATA_FINAL	DATE,
	PRIMARY KEY (CPF)
);

CREATE TABLE PROFESSOR_COLABORADOR(
	CPF 		VARCHAR(11) NOT NULL REFERENCES COLABORADOR(CPF),
	DATA_INICIAL	DATE NOT NULL,
	DATA_FINAL	DATE,
	PRIMARY KEY (CPF)
);

CREATE TABLE INSTIradTUICAO(
	CODIGO 		INTEGER NOT NULL,
	NOME		VARCHAR(30) NOT NULL,
	UNIDADE		VARCHAR(20),
	DEPARTAMENTO	VARCHAR(20),
	ENDERECO	VARCHAR(150),
	PRIMARY KEY (CODIGO)
);

CREATE TABLE POS_GRADUACAO(
	CODIGO 		INTEGER NOT NULL,
	NOME		VARCHAR(40) NOT NULL,
	TIPO		VARCHAR(20),
	PRIMARY KEY (CODIGO)
);

CREATE TABLE GRUPO_EXTERNO(
	NOME		VARCHAR(40) NOT NULL,
	COD_INST 	INTEGER  NOT NULL,
	PRIMARY KEY (NOME),
	FOREIGN KEY (COD_INST) REFERENCES INSTITUICAO(CODIGO) ON DELETE CASCADE
);

CREATE TABLE EQUIPE(
	CODIGO		INTEGER NOT NULL,
	PRIMARY KEY (CODIGO)
);

CREATE TABLE PROJETO(
	NUMERO		INTEGER NOT NULL,
	COD_EQUIPE	INTEGER NOT NULL,
	NUM_SUPER_PROJ	INTEGER,
	TITULO		VARCHAR(20) NOT NULL,
	DESCRICAO 	VARCHAR(50),
	DATA_INICIO	DATE NOT NULL,
	DATA_FIM	DATE,
	PRIMARY KEY (NUMERO),
	FOREIGN KEY (COD_EQUIPE) REFERENCES EQUIPE(CODIGO) ON DELETE CASCADE,
	FOREIGN KEY (NUM_SUPER_PROJ) REFERENCES PROJETO(NUMERO) ON DELETE CASCADE
);

CREATE TABLE BOLSA(
	CODIGO			INTEGER NOT NULL,
	COD_FINANCIADORA	INTEGER NOT NULL,
	CPF_PESQUISADOR		VARCHAR(11),
	DESCRICAO		VARCHAR(50),
	DATA_INICIAL_BOLSA	DATE NOT NULL,
	DATA_FINAL_BOLSA	DATE,
	PRIMARY KEY (CODIGO),
	FOREIGN KEY (COD_FINANCIADORA) REFERENCES FINANCIADORA(CODIGO) ON DELETE CASCADE,
	FOREIGN KEY (CPF_PESQUISADOR) REFERENCES PESQUISADOR(CPF) ON DELETE CASCADE
);

CREATE TABLE FINANCIADORA(
	CODIGO		INTEGER NOT NULL,
	TIPO		VARCHAR(20) NOT NULL,
	NOME		VARCHAR(30) NOT NULL,
	SIGLA		VARCHAR(10),
	ENDERECO 	VARCHAR(150),
	PRIMARY KEY (CODIGO)
);

CREATE TABLE CONTRIBUICAO(
	CODIGO			INTEGER NOT NULL,
	NUM_PROJETO		INTEGER NOT NULL,
	TIPO			VARCHAR(30),	
	PRIMARY KEY (CODIGO),
	FOREIGN KEY (NUM_PROJETO) REFERENCES PROJETO(NUMERO) ON DELETE CASCADE
);

CREATE TABLE TRABALHO_DE_IC(
	TITULO			VARCHAR(30) NOT NULL,
	COD_CONTRIBUICAO	INTEGER NOT NULL REFERENCES CONTRIBUICAO(CODIGO),
	CPF_GRADUANDO_IC	VARCHAR(11) NOT NULL,
	DATA_INICIAL		DATE NOT NULL,
	DATA_FINAL		DATE,	
	PRIMARY KEY (TITULO),
	FOREIGN KEY (CPF_GRADUANDO_IC) REFERENCES GRADUANDO_IC(CPF) ON DELETE CASCADE
);

CREATE TABLE DISSERTACAO(
	TITULO			VARCHAR(30) NOT NULL,
	COD_CONTRIBUICAO	INTEGER NOT NULL REFERENCES CONTRIBUICAO(CODIGO),
	CPF_MESTRANDO		VARCHAR(11) NOT NULL,	
	PRIMARY KEY (TITULO),
	FOREIGN KEY (CPF_MESTRANDO) REFERENCES MESTRANDO(CPF) ON DELETE CASCADE
);

CREATE TABLE TESE(
	TITULO			VARCHAR(30) NOT NULL,
	COD_CONTRIBUICAO	INTEGER NOT NULL REFERENCES CONTRIBUICAO(CODIGO),
	CPF_DOUTORANDO		VARCHAR(11) NOT NULL,	
	PRIMARY KEY (TITULO),
	FOREIGN KEY (CPF_DOUTORANDO) REFERENCES DOUTORANDO(CPF) ON DELETE CASCADE
);

CREATE TABLE ARTIGO(
	TITULO			VARCHAR(30) NOT NULL,
	COD_CONTRIBUICAO	INTEGER NOT NULL REFERENCES CONTRIBUICAO(CODIGO),
	QUALIS			VARCHAR(10),	
	PRIMARY KEY (TITULO)
);

CREATE TABLE RELATORIO(
	NUMERO			INTEGER NOT NULL,
	TITULO			VARCHAR(30) NOT NULL,
	COD_CONTRIBUICAO	INTEGER NOT NULL REFERENCES CONTRIBUICAO(CODIGO),
	ANO			DATE,	
	PRIMARY KEY (NUMERO)
);

CREATE TABLE CAPITULO_LIVRO(
	ISBN			INTEGER NOT NULL,
	TITULO			VARCHAR(30) NOT NULL,
	COD_CONTRIBUICAO	INTEGER NOT NULL REFERENCES CONTRIBUICAO(CODIGO),
	CAPITULO		VARCHAR(30) NOT NULL,
	PAGINAS			VARCHAR(10),
	AUTORES			VARCHAR(30),
	EDITORA			VARCHAR(30),
	ANO			DATE,	
	ENDERECO		VARCHAR(150),
	PRIMARY KEY (ISBN)
);

CREATE TABLE LIVRO(
	ISBN			INTEGER NOT NULL,
	TITULO			VARCHAR(30) NOT NULL,
	COD_CONTRIBUICAO	INTEGER NOT NULL REFERENCES CONTRIBUICAO(CODIGO),
	AUTORES			VARCHAR(30),
	EDITORA			VARCHAR(30),
	ANO			DATE,	
	ENDERECO		VARCHAR(150),
	BIBSOURCE		VARCHAR(50),
	PRIMARY KEY (ISBN)
);

CREATE TABLE APRESENTACAO(
	TITULO			VARCHAR(30) NOT NULL,
	COD_CONTRIBUICAO	INTEGER NOT NULL REFERENCES CONTRIBUICAO(CODIGO),
	ARQUIVO			VARCHAR(50),
	PRIMARY KEY (TITULO)
);

CREATE TABLE SOFTWARE(
	TITULO			VARCHAR(30) NOT NULL,
	COD_CONTRIBUICAO	INTEGER NOT NULL REFERENCES CONTRIBUICAO(CODIGO),
	DESCRICAO		VARCHAR(50),
	AUTORES			VARCHAR(30),
	DATA			DATE,	
	LICENCA			VARCHAR(50),
	REGISTRO		VARCHAR(50),
	PRIMARY KEY (TITULO)
);

CREATE TABLE PATENTE(
	TITULO			VARCHAR(30) NOT NULL,
	COD_CONTRIBUICAO	INTEGER NOT NULL REFERENCES CONTRIBUICAO(CODIGO),
	DATA			DATE,	
	ARQUIVO			VARCHAR(50),
	PRIMARY KEY (TITULO)
);

CREATE TABLE CONFERENCIA(
	CODIGO			INTEGER NOT NULL,
	NOME			VARCHAR(30) NOT NULL,
	DATA			DATE,	
	ENDERECO		VARCHAR(150),
	PRIMARY KEY (CODIGO)
);

CREATE TABLE WORKSHOP(
	NOME			VARCHAR(30) NOT NULL,
	COD_CONFERENCIA		INTEGER NOT NULL,
	DATA			DATE,
	PRIMARY KEY (NOME)
);

CREATE TABLE OUTRO_EVENTO(
	CODIGO			INTEGER NOT NULL,
	NOME			VARCHAR(30) NOT NULL,
	DESCRICAO		VARCHAR(50),
	DATA			DATE,
	ENDERECO		VARCHAR(150),
	PRIMARY KEY (CODIGO)
);

CREATE TABLE PERIODICO(
	CODIGO			INTEGER NOT NULL,
	NOME			VARCHAR(30) NOT NULL,
	PRIMARY KEY (CODIGO)
);

CREATE TABLE PREMIO(
	CODIGO			INTEGER NOT NULL,
	COD_CONTRIBUICAO	INTEGER NOT NULL,
	NOME_PREMIADORA		VARCHAR(30) NOT NULL,
	DESCRICAO		VARCHAR(50),
	DATA			DATE,
	PRIMARY KEY (CODIGO),
	FOREIGN KEY (COD_CONTRIBUICAO) REFERENCES CONTRIBUICAO(CODIGO) ON DELETE CASCADE,
	FOREIGN KEY (NOME_PREMIADORA) REFERENCES PREMIADORA(NOME) ON DELETE CASCADE
);

CREATE TABLE PREMIADORA(
	NOME		VARCHAR(30) NOT NULL,
	SIGLA		VARCHAR(10),
	PRIMARY KEY (NOME)
);

CREATE TABLE INTERCAMBIO_MESTRADO(
	DATA_INICIAL	DATE NOT NULL,
	CPF 		VARCHAR(11) NOT NULL,
	DATA_FINAL	DATE,
	PRIMARY KEY (DATA_INICIAL),
	FOREIGN KEY (CPF) REFERENCES MESTRANDO(CPF) ON DELETE CASCADE
);

CREATE TABLE INTERCAMBIO_DOUTORADO(
	DATA_INICIAL	DATE NOT NULL,
	CPF 		VARCHAR(11) NOT NULL,
	DATA_FINAL	DATE,
	PRIMARY KEY (DATA_INICIAL),
	FOREIGN KEY (CPF) REFERENCES DOUTORANDO(CPF) ON DELETE CASCADE
);

CREATE TABLE BANCA(
	CODIGO INTEGER NOT NULL,
	PRIMARY KEY (CODIGO)
);

CREATE TABLE EQ_MESTRADO(
	CODIGO 		INTEGER NOT NULL,
	CPF_MESTRANDO	VARCHAR(11) NOT NULL,
	COD_BANCA	INTEGER NOT NULL,
	DATA		DATE,
	RESULTADO	VARCHAR(10),
	LOCAL		VARCHAR(50),
	PRIMARY KEY (CODIGO),
	FOREIGN KEY (CPF_MESTRANDO) REFERENCES MESTRANDO(CPF) ON DELETE CASCADE,
	FOREIGN KEY (COD_BANCA) REFERENCES BANCA(CODIGO) ON DELETE CASCADE
);

CREATE TABLE EQ_DOUTORADO(
	CODIGO 		INTEGER NOT NULL,
	CPF_DOUTORANDO	VARCHAR(11) NOT NULL,
	COD_BANCA	INTEGER NOT NULL,
	DATA		DATE,
	RESULTADO	VARCHAR(10),
	LOCAL		VARCHAR(50),
	PRIMARY KEY (CODIGO),
	FOREIGN KEY (CPF_DOUTORANDO) REFERENCES DOUTORANDO(CPF) ON DELETE CASCADE,
	FOREIGN KEY (COD_BANCA) REFERENCES BANCA(CODIGO) ON DELETE CASCADE
);

INSERT INTO PESQUISADOR VALUES('1','Ricardo da Silva Torres', 'Doutor', 
'Rua Um 100 Bar√£o Geraldo Campinas - SP, 12456-363', '(19)2522-2222', 'rtorres@ic.unicamp.br', 
'http://buscatextual.cnpq.br/buscatextual/visualizacv.jsp?id=K4769295A9', '0', '1', '0');