CREATE DATABASE LABORATORIO;

CREATE TABLE PESQUISADOR(
	CPF 		VARCHAR(11) NOT NULL,
	NOME		VARCHAR(40) NOT NULL,
	TITULACAO	VARCHAR(50),
	ENDERECO	VARCHAR(150),
	TELEFONE	VARCHAR(15),
	EMAIL		VARCHAR(30),
	BIOGRAFIA	VARCHAR(100),
	IS_ALUNO	TINYINT(1) NOT NULL,
	IS_PROFESSOR	TINYINT(1) NOT NULL,
	IS_COLABORADOR	TINYINT(1) NOT NULL,
	PRIMARY KEY (CPF)
);

CREATE TABLE ALUNO(
	CPF 	VARCHAR(11) NOT NULL REFERENCES PESQUISADOR(CPF),
	RA		VARCHAR(10) NOT NULL,
	PRIMARY KEY (CPF)
);

CREATE TABLE GRADUANDOIC(
	CPF 		VARCHAR(11) NOT NULL REFERENCES ALUNO(CPF),
	DATA_INICIAL	DATE NOT NULL,
	DATA_FINAL	DATE,
	PRIMARY KEY (CPF)
);

CREATE TABLE MESTRANDO(
	CPF 		VARCHAR(11) NOT NULL REFERENCES ALUNO(CPF),
	DATA_INICIAL	DATE NOT NULL,
	DATA_FINAL	DATE,
	PRIMARY KEY (CPF)
);

CREATE TABLE DOUTORANDO(
	CPF 		VARCHAR(11) NOT NULL REFERENCES ALUNO(CPF),
	DATA_INICIAL	DATE NOT NULL,
	DATA_FINAL	DATE,
	PRIMARY KEY (CPF)
);

CREATE TABLE PROFESSOR(
	CPF 				VARCHAR(11) NOT NULL REFERENCES PESQUISADOR(CPF),
	DATA_INICIAL			DATE  NOT NULL,
	DATA_FINAL			DATE,
	NOME_LABORATORIO		VARCHAR(30),
	DATA_INICIAL_COORDENA_LAB	DATE,
	DATA_FINAL_COORDENA_LAB		DATE,
	PRIMARY KEY (CPF)
);

CREATE TABLE LABORATORIO(
	NOME 		VARCHAR(30) NOT NULL,
	ENDERECO	VARCHAR(150),
	PRIMARY KEY (NOME)
);

CREATE TABLE COLABORADOR(
	CPF 			VARCHAR(11) NOT NULL REFERENCES PESQUISADOR(CPF),
	IS_POS_DOUTORANDO	TINYINT(1) NOT NULL,
	IS_PROF			TINYINT(1) NOT NULL,
	PRIMARY KEY (CPF)
);

CREATE TABLE POS_DOUTORANDO(
	CPF 		VARCHAR(11) NOT NULL REFERENCES COLABORADOR(CPF),
	DATA_INICIAL	DATE NOT NULL,
	DATA_FINAL	DATE,
	PRIMARY KEY (CPF)
);

CREATE TABLE PROFESSOR_COLABORADOR(
	CPF 		VARCHAR(11) NOT NULL REFERENCES COLABORADOR(CPF),
	DATA_INICIAL	DATE NOT NULL,
	DATA_FINAL	DATE,
	PRIMARY KEY (CPF)
);

CREATE TABLE INSTITUICAO(
	CODIGO 		INTEGER NOT NULL,
	NOME		VARCHAR(30) NOT NULL,
	UNIDADE		VARCHAR(20),
	DEPARTAMENTO	VARCHAR(20),
	ENDERECO	VARCHAR(150),
	PRIMARY KEY (CODIGO)
);

CREATE TABLE POS_GRADUACAO(
	CODIGO 		INTEGER NOT NULL,
	NOME		VARCHAR(40) NOT NULL,
	TIPO		VARCHAR(20),
	PRIMARY KEY (CODIGO)
);

CREATE TABLE GRUPO_EXTERNO(
	NOME		VARCHAR(40) NOT NULL,
	COD_INST 	INTEGER  NOT NULL,
	PRIMARY KEY (NOME),
	FOREIGN KEY (COD_INST) REFERENCES INSTITUICAO(CODIGO) ON DELETE CASCADE
);

CREATE TABLE EQUIPE(
	CODIGO		INTEGER NOT NULL,
	PRIMARY KEY (CODIGO)
);

CREATE TABLE PROJETO(
	NUMERO		INTEGER NOT NULL,
	COD_EQUIPE	INTEGER NOT NULL,
	NUM_SUPER_PROJ	INTEGER,
	TITULO		VARCHAR(20) NOT NULL,
	DESCRICAO 	VARCHAR(250),
	DATA_INICIO	DATE NOT NULL,
	DATA_FIM	DATE,
	PRIMARY KEY (NUMERO),
	FOREIGN KEY (COD_EQUIPE) REFERENCES EQUIPE(CODIGO) ON DELETE CASCADE,
	FOREIGN KEY (NUM_SUPER_PROJ) REFERENCES PROJETO(NUMERO) ON DELETE CASCADE
);

CREATE TABLE BOLSA(
	CODIGO			INTEGER NOT NULL,
	COD_FINANCIADORA	INTEGER NOT NULL,
	CPF_PESQUISADOR		VARCHAR(11),
	DESCRICAO		VARCHAR(50),
	DATA_INICIAL_BOLSA	DATE NOT NULL,
	DATA_FINAL_BOLSA	DATE,
	PRIMARY KEY (CODIGO),
	FOREIGN KEY (COD_FINANCIADORA) REFERENCES FINANCIADORA(CODIGO) ON DELETE CASCADE,
	FOREIGN KEY (CPF_PESQUISADOR) REFERENCES PESQUISADOR(CPF) ON DELETE CASCADE
);

CREATE TABLE FINANCIADORA(
	CODIGO		INTEGER NOT NULL,
	TIPO		VARCHAR(20) NOT NULL,
	NOME		VARCHAR(30) NOT NULL,
	SIGLA		VARCHAR(10),
	ENDERECO 	VARCHAR(150),
	PRIMARY KEY (CODIGO)
);

CREATE TABLE CONTRIBUICAO(
	CODIGO			INTEGER NOT NULL,
	NUM_PROJETO		INTEGER NOT NULL,
	TIPO			VARCHAR(30),	
	PRIMARY KEY (CODIGO),
	FOREIGN KEY (NUM_PROJETO) REFERENCES PROJETO(NUMERO) ON DELETE CASCADE
);

CREATE TABLE TRABALHO_DE_IC(
	COD_CONTRIBUICAO	INTEGER NOT NULL REFERENCES CONTRIBUICAO(CODIGO),
	CPF_GRADUANDO_IC	VARCHAR(11) NOT NULL,
	TITULO			VARCHAR(50) NOT NULL,
	DATA_INICIAL		DATE NOT NULL,
	DATA_FINAL		DATE,	
	PRIMARY KEY (COD_CONTRIBUICAO),
	FOREIGN KEY (CPF_GRADUANDO_IC) REFERENCES GRADUANDO_IC(CPF) ON DELETE CASCADE
);

CREATE TABLE DISSERTACAO(
	COD_CONTRIBUICAO	INTEGER NOT NULL REFERENCES CONTRIBUICAO(CODIGO),
	CPF_MESTRANDO		VARCHAR(11) NOT NULL,	
	TITULO			VARCHAR(50) NOT NULL,
	PRIMARY KEY (COD_CONTRIBUICAO),
	FOREIGN KEY (CPF_MESTRANDO) REFERENCES MESTRANDO(CPF) ON DELETE CASCADE
);

CREATE TABLE TESE(
	COD_CONTRIBUICAO	INTEGER NOT NULL REFERENCES CONTRIBUICAO(CODIGO),
	CPF_DOUTORANDO		VARCHAR(11) NOT NULL,	
	TITULO			VARCHAR(50) NOT NULL,
	PRIMARY KEY (COD_CONTRIBUICAO),
	FOREIGN KEY (CPF_DOUTORANDO) REFERENCES DOUTORANDO(CPF) ON DELETE CASCADE
);

CREATE TABLE ARTIGO(
	COD_CONTRIBUICAO	INTEGER NOT NULL REFERENCES CONTRIBUICAO(CODIGO),
	TITULO			VARCHAR(50) NOT NULL,
	QUALIS			VARCHAR(10),	
	PRIMARY KEY (COD_CONTRIBUICAO)
);

CREATE TABLE RELATORIO(
	COD_CONTRIBUICAO	INTEGER NOT NULL REFERENCES CONTRIBUICAO(CODIGO),
	NUMERO			INTEGER NOT NULL,
	TITULO			VARCHAR(50) NOT NULL,
	ANO			DATE,	
	PRIMARY KEY (COD_CONTRIBUICAO)
);

CREATE TABLE CAPITULO_LIVRO(
	COD_CONTRIBUICAO	INTEGER NOT NULL REFERENCES CONTRIBUICAO(CODIGO),
	ISBN			INTEGER NOT NULL,
	TITULO			VARCHAR(30) NOT NULL,	
	CAPITULO		VARCHAR(30) NOT NULL,
	PAGINAS			VARCHAR(10),
	AUTORES			VARCHAR(30),
	EDITORA			VARCHAR(30),
	ANO			DATE,	
	ENDERECO		VARCHAR(150),
	PRIMARY KEY (COD_CONTRIBUICAO)
);

CREATE TABLE LIVRO(
	COD_CONTRIBUICAO	INTEGER NOT NULL REFERENCES CONTRIBUICAO(CODIGO),
	ISBN			INTEGER NOT NULL,
	TITULO			VARCHAR(30) NOT NULL,	
	AUTORES			VARCHAR(30),
	EDITORA			VARCHAR(30),
	ANO			DATE,	
	ENDERECO		VARCHAR(150),
	BIBSOURCE		VARCHAR(50),
	PRIMARY KEY (COD_CONTRIBUICAO)
);

CREATE TABLE APRESENTACAO(
	COD_CONTRIBUICAO	INTEGER NOT NULL REFERENCES CONTRIBUICAO(CODIGO),
	TITULO			VARCHAR(30) NOT NULL,
	ARQUIVO			VARCHAR(50),
	PRIMARY KEY (COD_CONTRIBUICAO)
);

CREATE TABLE SOFTWARE(
	COD_CONTRIBUICAO	INTEGER NOT NULL REFERENCES CONTRIBUICAO(CODIGO),
	TITULO			VARCHAR(30) NOT NULL,
	DESCRICAO		VARCHAR(50),
	AUTORES			VARCHAR(30),
	DATA			DATE,	
	LICENCA			VARCHAR(50),
	REGISTRO		VARCHAR(50),
	PRIMARY KEY (COD_CONTRIBUICAO)
);

CREATE TABLE PATENTE(
	COD_CONTRIBUICAO	INTEGER NOT NULL REFERENCES CONTRIBUICAO(CODIGO),
	TITULO			VARCHAR(30) NOT NULL,
	DATA			DATE,	
	ARQUIVO			VARCHAR(50),
	PRIMARY KEY (COD_CONTRIBUICAO)
);

CREATE TABLE CONFERENCIA(
	CODIGO			INTEGER NOT NULL,
	NOME			VARCHAR(30) NOT NULL,
	DATA			DATE,	
	ENDERECO		VARCHAR(150),
	PRIMARY KEY (CODIGO)
);

CREATE TABLE WORKSHOP(
	NOME			VARCHAR(30) NOT NULL,
	COD_CONFERENCIA		INTEGER NOT NULL,
	DATA			DATE,
	PRIMARY KEY (NOME)
);

CREATE TABLE OUTRO_EVENTO(
	CODIGO			INTEGER NOT NULL,
	NOME			VARCHAR(30) NOT NULL,
	DESCRICAO		VARCHAR(50),
	DATA			DATE,
	ENDERECO		VARCHAR(150),
	PRIMARY KEY (CODIGO)
);

CREATE TABLE PERIODICO(
	CODIGO			INTEGER NOT NULL,
	NOME			VARCHAR(30) NOT NULL,
	PRIMARY KEY (CODIGO)
);

CREATE TABLE PREMIO(
	CODIGO			INTEGER NOT NULL,
	COD_CONTRIBUICAO	INTEGER NOT NULL,
	NOME_PREMIADORA		VARCHAR(30) NOT NULL,
	DESCRICAO		VARCHAR(50),
	DATA			DATE,
	PRIMARY KEY (CODIGO),
	FOREIGN KEY (COD_CONTRIBUICAO) REFERENCES CONTRIBUICAO(CODIGO) ON DELETE CASCADE,
	FOREIGN KEY (NOME_PREMIADORA) REFERENCES PREMIADORA(NOME) ON DELETE CASCADE
);

CREATE TABLE PREMIADORA(
	NOME		VARCHAR(30) NOT NULL,
	SIGLA		VARCHAR(10),
	PRIMARY KEY (NOME)
);

CREATE TABLE INTERCAMBIO_MESTRADO(
	DATA_INICIAL	DATE NOT NULL,
	CPF 		VARCHAR(11) NOT NULL,
	DATA_FINAL	DATE,
	PRIMARY KEY (DATA_INICIAL, CPF)
);

CREATE TABLE INTERCAMBIO_DOUTORADO(
	DATA_INICIAL	DATE NOT NULL,
	CPF 		VARCHAR(11) NOT NULL,
	DATA_FINAL	DATE,
	PRIMARY KEY (DATA_INICIAL, CPF)
);

CREATE TABLE BANCA(
	CODIGO INTEGER NOT NULL,
	PRIMARY KEY (CODIGO)
);

CREATE TABLE EQ_MESTRADO(
	CODIGO 		INTEGER NOT NULL,
	CPF_MESTRANDO	VARCHAR(11) NOT NULL,
	COD_BANCA	INTEGER NOT NULL,
	DATA		DATE,
	RESULTADO	VARCHAR(10),
	LOCAL		VARCHAR(50),
	PRIMARY KEY (CODIGO),
	FOREIGN KEY (CPF_MESTRANDO) REFERENCES MESTRANDO(CPF) ON DELETE CASCADE,
	FOREIGN KEY (COD_BANCA) REFERENCES BANCA(CODIGO) ON DELETE CASCADE
);

CREATE TABLE EQ_DOUTORADO(
	CODIGO 		INTEGER NOT NULL,
	CPF_DOUTORANDO	VARCHAR(11) NOT NULL,
	COD_BANCA	INTEGER NOT NULL,
	DATA		DATE,
	RESULTADO	VARCHAR(10),
	LOCAL		VARCHAR(50),
	PRIMARY KEY (CODIGO),
	FOREIGN KEY (CPF_DOUTORANDO) REFERENCES DOUTORANDO(CPF) ON DELETE CASCADE,
	FOREIGN KEY (COD_BANCA) REFERENCES BANCA(CODIGO) ON DELETE CASCADE
);

INSERT INTO PESQUISADOR VALUES('1','Ricardo da Silva Torres', 'Doutor', 
'Rua Um 100 BarÃ£o Geraldo Campinas - SP, 12456-363', '(19)2522-2222', 'rtorres@ic.unicamp.br', 
'http://buscatextual.cnpq.br/buscatextual/visualizacv.jsp?id=K4769295A9', '0', '1', '0');
INSERT INTO PESQUISADOR VALUES('22222222222', 'Anderson de Rezende Rocha, Doutor', 'Rua 1, 123', '1935215854', 'arocha@ic.unicamp.br', 'http://buscatextual.cnpq.br/buscatextual/visualizacv.do?id=K4702293H8', 0, 1, 0);
INSERT INTO PROFESSOR VALUES('22222222222', '2010-01-01', null, null, null, null);
INSERT INTO PROFESSOR  VALUES('11111111111', '2005-01-01', null, 'RECOD', '2005-01-01', null);
INSERT INTO PESQUISADOR  VALUES('33333333333', 'Jurandy Gomes de Almeida Junior', 'Doutor', 'Rua 3, 123', '1581198368', 'jurandy@ic.unicamp.br', 'http://buscatextual.cnpq.br/buscatextual/visualizacv.do?id=K4736755E0', 1, 0, 1);
INSERT INTO MESTRANDO  VALUES('33333333333', '2005-01-01', '2007-01-01');
INSERT INTO DOUTORANDO  VALUES('33333333333', '2007-02-01', '2011-02-01');
INSERT INTO COLABORADOR  VALUES('33333333333', 1, 0);
INSERT INTO POS_DOUTORANDO  VALUES('33333333333', '2011-02-01', null);
INSERT INTO CONTRIBUICAO  VALUES(1, 2, 'DISSERTACAO');
INSERT INTO DISSERTACAO VALUES('Recuperação de Imagens por Cor utilizando Análise de Distribuição Discreta de Características', 1, '33333333333');
INSERT INTO PESQUISADOR  VALUES('44444444444', 'Siome Klein Goldenstein', 'Doutor', 'Avenida Alberto Einstein, 1251', '1935215847', 'siome@ic.unicamp.br', 'http://buscatextual.cnpq.br/buscatextual/visualizacv.do?id=K4791970Z1', 0, 1, 0);
INSERT INTO PROFESSOR  VALUES('44444444444', '2003-01-01', null, null, null, null);
INSERT INTO PESQUISADOR  VALUES('55555555555', 'Jefersson Alex dos Santos', 'Mestre', 'Rua 3, 125', '1535149456', 'jefersson@ic.unicamp.br', 'http://buscatextual.cnpq.br/buscatextual/visualizacv.do?id=K4719937Z8', 1, 0, 1);
INSERT INTO MESTRANDO  VALUES('55555555555', '2007-01-01', '2009-01-01');
INSERT INTO DOUTORANDO VALUES('55555555555', '2009-01-01', null);
INSERT INTO INTERCAMBIO_DOUTORADO VALUES('55555555555', '2010-01-01', null);
INSERT INTO PESQUISADOR  VALUES('66666666666', 'Hélio Pedrini', 'Doutor', 'Rua 5, 555', '1935215919', 'helio@ic.unicamp.br', 'http://buscatextual.cnpq.br/buscatextual/visualizacv.do?id=K4795613T2', 0, 0, 1);
INSERT INTO COLABORADOR  VALUES('66666666666', 0, 1);
INSERT INTO PROFESSOR_COLABORADOR VALUES('66666666666', '2009-02-01', null);
INSERT INTO PESQUISADOR  VALUES('77777777777', 'Patricia Morellato', 'Doutor', 'Rua 5, 555', '1935215919','patricia@ic.unicamp.br', 'http://buscatextual.cnpq.br/buscatextual/visualizacv.do?id=K0000000T0', 0, 0, 1);
INSERT INTO COLABORADOR  VALUES('77777777777', 0, 0);
INSERT INTO PROJETO VALUES(1, 1, null, 'e-phenology', 'e-phenology: The application of new technologies to monitor plant phenology and track climate changes in the tropics', '2006-01-01', null);
INSERT INTO PROJETO VALUES(4, 1, 1, 'e-phenology 2', 'e-phenology 2: subprojeto', '2007-01-01', null);
INSERT INTO PROJETO VALUES(2, 2, null, 'dummyProj1', 'um projeto realizado entre 2009 e 2010', '2009-04-01', '2010-04-01');
INSERT INTO PROJETO VALUES(3, 3, null, 'dummyProj2', 'um projeto realizado entre 2008 e 2010', '2008-04-01', '2010-04-01');
INSERT INTO PROJETO VALUES(5, 5, null, 'dummyProj3', 'um projeto realizado entre 2008 e 2012', '2008-04-01', '2012-04-01');
INSERT INTO EQUIPE VALUES(1);
INSERT INTO FINANCIADORA VALUES(1, 'agência', 'Fundação de Amparo à Pesquisa do Estado de São Paulo', 'FAPESP', 'Rua da FAPESP, 123');
INSERT INTO FINANCIADORA VALUES(1, 'empresa', 'Microsoft', 'Microsoft', 'Rua da Microsoft, 123');
INSERT INTO CONTRIBUICAO VALUES(1, 1, 'ARTIGO');
INSERT INTO ARTIGO VALUES(1, 'Artigo e-phenology', 'A1');  
INSERT INTO CONTRIBUICAO VALUES(2, 5, 'ARTIGO');
INSERT INTO ARTIGO VALUES(2, 'Vision of the Unseen: Current Trends and Challenges in Digital Image and Video Forensics', 'A1');